---
title: "Cookies and Gaussians"
date: "2025-09-22"
toc: true
categories: [R, Probability, Statistics, Probabilistic graphical models]
image: "thumbnail.png"
---

You‚Äôre a data scientist at a cookie convention. What do you do? Survey the participants and fit a Gaussian mixture model, of course. üç™ üòã

# Exploratory cookie analysis

```{python}
#| echo: false
#| include: false
#| warning: false
#| message: false

import scipy.stats as ss
import matplotlib.pyplot as plt
import numpy as np
import seaborn as sns

np.random.seed(42)
plt.style.use("../../aux-files/custom-theme.mplstyle")
yellow = "#FFC300"
blue = "#3399FF"
pink = "#FF3399"
grey = "#121212"
white = "#E5E5E5"

```

You surveyed 1,000 cookie convention attendees to find out just how many cookies they could devour in a single day. Naturally, being the conscientious data scientist you are, you fired up `Python` and loaded the results into a `NumPy` array to crunch some summary statistics:

```{python}
#| echo: true
#| code-fold: true
#| fig-align: center

data = np.load("cookie_data.npy")
data_count = len(data)
data_mean = np.mean(data)
data_sd = np.std(data)

print(f"There are {data_count} observations in the data.")
print(f"The first five observations are {data[:5]}.")
print(f"The data mean is {data_mean:.2f}, while the standard deviation is {data_sd:.2f}.")

```

Of course, every good data scientist wants to *see* the data, so you whip up a `Seaborn` histogram to get the full cookie picture:

```{python}
#| echo: true
#| code-fold: true 
#| fig-align: center

sns.histplot(data=data, color=yellow, alpha=1, ec=grey, zorder=2)
plt.xlabel('x = number of cookies')
plt.ylabel('count')
plt.title('cookie data')
plt.show()

```

Three clusters! One has a peak around 10 cookies, the second around 15, and the third has a peak near a whopping 21 cookies. Clearly, there are distinct groups of cookie lovers here, which makes this dataset is a perfect candidate for a *Gaussian mixture model* (*GMM*), which seeks to identify clusters in data.

# Fitting a GMM in scikit-learn

```{python}
#| echo: true
#| code-fold: false
#| fig-align: center

from sklearn.mixture import GaussianMixture

X = data.reshape(-1, 1)

gmm = GaussianMixture(n_components=3, random_state=42)
gmm.fit(X)

means = gmm.means_.flatten()
stds = np.sqrt(gmm.covariances_).flatten()
weights = gmm.weights_
params = [{"loc": mu, "scale": sigma} for mu, sigma in zip(means, stds)]

print("Means:", means)
print("Standard deviations:", stds)
print("Weights:", weights)

```

```{python}
#| echo: true
#| code-fold: false 
#| fig-align: center

def mixture_pdf(x):  
  return sum([weight * ss.norm(**param).pdf(x) for weight, param in zip(weights, params)])

mesh = np.linspace(8, 22, num=200)

sns.histplot(data=data, color=yellow, alpha=0.5, ec=grey, zorder=2, stat="density", label="data")
plt.plot(mesh, mixture_pdf(mesh), color=blue, label="GMM PDF")
plt.xlabel("x = number of cookies")
plt.ylabel("density")
plt.title("data + GMM PDF")
plt.legend()
plt.tight_layout()
plt.show()

```
